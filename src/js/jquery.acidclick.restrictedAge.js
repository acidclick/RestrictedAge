// Generated by CoffeeScript 1.6.2
(function() {
  (function($, window) {
    return $.extend($.fn, {
      restrictedAge: function(options) {
        var restrictedAgeConfirmed, settings,
          _this = this;

        this.defaultOptions = {
          title: '',
          text: '',
          agreeBtnText: 'agree',
          disagreeBtnText: 'disagree',
          disagreeUrl: '',
          persistent: false
        };
        settings = $.extend({}, this.defaultOptions, options);
        restrictedAgeConfirmed = function() {
          var pattern; 

          pattern = /restrictedAgeConfirmed=true/;
          return pattern.test(document.cookie);
        };
        this.each(function(i, el) {
          var $agreeBtn, $disagreeBtn, $el, $fullscreen, $text, $title, $wrapper;

          $el = $(el);
          if (restrictedAgeConfirmed() === true) {
            return;
          }
          $fullscreen = $('<div id="restrictedAge" style="display:none"></div>');
          $wrapper = $('<div class="restrictedAgeWrapper"></div>');
          $title = $('<h2></h2>');
          $text = $('<p class="restrictedAgeText"></p>');
          $agreeBtn = $('<a href="#" class="agreeBtn"></a>');
          $disagreeBtn = $('<a href="#" class="disagreeBtn"></a>');
          $title.html(settings.title);
          $text.html(settings.text);
          $agreeBtn.html(settings.agreeBtnText);
          $disagreeBtn.html(settings.disagreeBtnText);
          $disagreeBtn.attr('href', settings.disagreeBtnUrl);
          $agreeBtn.on('click', function(event) {
            var date, plus;

            event.preventDefault();
            date = new Date();
            plus = settings.persistent ? 1 : 365;
            date.setDate(date.getDate() + plus);
            document.cookie = 'restrictedAgeConfirmed=true; expires=' + date.toUTCString();
            return $fullscreen.fadeOut();
          });
          $fullscreen.append($wrapper);
          if (settings.title !== '') {
            $wrapper.append($title);
          }
          $wrapper.append($text);
          $wrapper.append($agreeBtn);
          $wrapper.append($disagreeBtn);
          $el.append($fullscreen);
          return $fullscreen.fadeIn();
        });
        return this;
      }
    });
  })(this.jQuery || this.Zepto, this);

}).call(this);
